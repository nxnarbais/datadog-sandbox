{"title":"[Narbais][KB] Right sizing","description":"datadog_demo_keep:true","widgets":[{"id":2993687432395610,"definition":{"type":"note","content":"# Rightsizing\n\nDashboard developed using [AWS recommendations](https://docs.aws.amazon.com/whitepapers/latest/cost-optimization-right-sizing/tips-for-right-sizing-your-workloads.html) for right sizing against CPU and Memory for EC2 instances.\n\n> *Identify instances with a maximum CPU usage and memory usage of less than 40% over a four-week period. These are the instances that you will want to right size to reduce costs.*","background_color":"white","font_size":"16","text_align":"left","show_tick":false,"tick_pos":"50%","tick_edge":"left"},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":6690462419943810,"definition":{"title":"Underutilized Instances by both CPU and Memory (Top 50 - sorted by Memory)","type":"query_table","requests":[{"q":"max:aws.ec2.cpuutilization.maximum{$team,$service,$awsaccount} by {host, team, service, aws_account}","aggregator":"max","conditional_formats":[{"custom_bg_color":"#cc2a2a","custom_fg_color":"#d56f6f","comparator":"<","palette":"white_on_red","value":40},{"comparator":"<","palette":"white_on_yellow","value":60}],"alias":"max cpu"},{"aggregator":"min","conditional_formats":[{"comparator":">","palette":"white_on_red","value":0.6},{"comparator":">","palette":"white_on_yellow","value":0.4}],"q":"min:system.mem.pct_usable{$team,$service,$awsaccount} by {host, team, service, aws_account}","alias":"min usable memory","limit":50,"order":"desc"}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":5707873996879622,"definition":{"title":"CPU","type":"group","layout_type":"ordered","widgets":[{"id":5883156081523174,"definition":{"title":"Guideline: Maximum CPU usage < 40%","type":"query_table","requests":[{"aggregator":"max","conditional_formats":[{"comparator":"<","palette":"white_on_red","value":40},{"comparator":"<","palette":"white_on_yellow","value":60}],"q":"max:aws.ec2.cpuutilization.maximum{$awsaccount,$service,$team} by {host, team, service, aws_account}","alias":"max cpu","limit":25,"order":"asc"}]},"layout":{"x":0,"y":0,"width":6,"height":4}},{"id":8951063616079592,"definition":{"title":"Right Sizing Guideline: Maximum CPU usage < 40% (Lowest 100)","show_legend":true,"legend_size":"0","legend_layout":"auto","type":"timeseries","requests":[{"q":"top(max:aws.ec2.cpuutilization.maximum{$team,$service,$awsaccount} by {host,team,service,aws_account}.rollup(60), 100, 'last', 'asc')","style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false,"scale":"log"},"markers":[{"label":" 60 - 100 - ok ","value":"60 < y < 100","display_type":"ok solid"},{"label":" < 60 - potential underutilzation ","value":"40 < y < 60","display_type":"warning solid"},{"label":" < 40 - needs right-sizing ","value":"0 < y < 40","display_type":"error solid"}]},"layout":{"x":6,"y":0,"width":6,"height":4}}]},"layout":{"x":0,"y":3,"width":12,"height":5}},{"id":7755759082340150,"definition":{"title":"Memory","type":"group","layout_type":"ordered","widgets":[{"id":237396988348618,"definition":{"title":"Guideline: Maximum memory usage < 0.4","type":"query_table","requests":[{"aggregator":"min","conditional_formats":[{"comparator":">","palette":"white_on_red","value":0.6},{"comparator":">","palette":"white_on_yellow","value":0.4}],"q":"min:system.mem.pct_usable{$team,$awsaccount,$service} by {host, team, service, aws_account}","alias":"min usable memory","limit":25,"order":"desc"}]},"layout":{"x":0,"y":0,"width":6,"height":4}},{"id":2934759536174320,"definition":{"title":"Right Sizing Guideline: Maximum memory usage < 40% (lowest 100)","show_legend":true,"legend_size":"0","legend_layout":"auto","type":"timeseries","requests":[{"q":"1-top(ewma_20(min:system.mem.pct_usable{$team,$service,$awsaccount} by {host,team,service,aws_account}), 100, 'last', 'desc')","style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[{"label":" 60 - 100 - ok ","value":"y > 0.6","display_type":"ok solid"},{"label":" < 60 - potential underutilzation ","value":"0.4 < y < 0.6","display_type":"warning solid"},{"label":" < 40 - needs right-sizing ","value":"0 < y < 0.4","display_type":"error solid"}]},"layout":{"x":6,"y":0,"width":6,"height":4}}]},"layout":{"x":0,"y":8,"width":12,"height":5}}],"template_variables":[{"name":"team","default":"*","prefix":"team","available_values":[]},{"name":"service","default":"*","prefix":"service","available_values":[]},{"name":"awsaccount","default":"172597598159","prefix":"aws_account","available_values":[]}],"layout_type":"ordered","is_read_only":false,"notify_list":[],"reflow_type":"fixed","id":"vud-rtp-a2z"}